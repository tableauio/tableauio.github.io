<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://tableauio.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://tableauio.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://tableauio.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(a){/^global-alert-/.test(a)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://tableauio.github.io/main.eb790286c6f9bb807436460dcac04f26be4a3a28b22937e81957e39639aba5f375714eed5799d2c7ee35c615d6158ad51fdd3d80cff6d1a70be6b3328ffb5d55.css integrity="sha512-63kChsb5u4B0NkYNysBPJr5KOiiyKTfoGVfjljmrpfN1cU7tV5nSx+41xhXWFYrVH909gM/20acL5rMyj/tdVQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Map - Tableau</title><meta name=description content="Excel map guide."><link rel=canonical href=https://tableauio.github.io/docs/excel/map/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Map"><meta property="og:description" content="Excel map guide."><meta property="og:url" content="https://tableauio.github.io/docs/excel/map/"><meta property="og:site_name" content="Tableau"><meta property="article:published_time" content="2022-02-26T13:59:39+08:00"><meta property="article:modified_time" content="2025-05-30T21:30:20+08:00"><meta property="og:image" content="https://tableauio.github.io/tableau-logo.png"><meta property="og:image:alt" content="Tableau"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@wenchyzhu"><meta name=twitter:creator content="@wenchyzhu"><meta name=twitter:title content="Map"><meta name=twitter:description content="Excel map guide."><meta name=twitter:image content="https://tableauio.github.io/tableau-logo.png"><meta name=twitter:image:alt content="Map"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://tableauio.github.io/#/schema/organization/1","name":"Tableauio","url":"https://tableauio.github.io/","sameAs":["https://twitter.com/tableauio","https://github.com/tableauio/tableau"],"logo":{"@type":"ImageObject","@id":"https://tableauio.github.io/#/schema/image/1","url":"https://tableauio.github.io/tableau-logo.png","width":512,"height":512,"caption":"Tableauio"},"image":{"@id":"https://tableauio.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://tableauio.github.io/#/schema/website/1","url":"https://tableauio.github.io/","name":"Tableau","description":"Tableau can convert Excel\/CSV\/XML\/YAML to multiple formats: JSON, Text, and Bin.","publisher":{"@id":"https://tableauio.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://tableauio.github.io/docs/excel/map/","url":"https://tableauio.github.io/docs/excel/map/","name":"Map","description":"Excel map guide.","isPartOf":{"@id":"https://tableauio.github.io/#/schema/website/1"},"about":{"@id":"https://tableauio.github.io/#/schema/organization/1"},"datePublished":"2022-02-26T13:59:39CET","dateModified":"2025-05-30T21:30:20CET","breadcrumb":{"@id":"https://tableauio.github.io/docs/excel/map/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://tableauio.github.io/docs/excel/map/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://tableauio.github.io/docs/excel/map/"]}]},{"@type":"BreadcrumbList","@id":"https://tableauio.github.io/docs/excel/map/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://tableauio.github.io","url":"https://tableauio.github.io","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://tableauio.github.io/docs/","url":"https://tableauio.github.io/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://tableauio.github.io/docs/excel/","url":"https://tableauio.github.io/docs/excel/","name":"Excel"}},{"@type":"ListItem","position":5,"item":{"@id":"https://tableauio.github.io/docs/excel/map/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://tableauio.github.io/#/schema/article/1","headline":"Map","description":"Excel map guide.","isPartOf":{"@id":"https://tableauio.github.io/docs/excel/map/"},"mainEntityOfPage":{"@id":"https://tableauio.github.io/docs/excel/map/"},"datePublished":"2022-02-26T13:59:39CET","dateModified":"2025-05-30T21:30:20CET","author":{"@id":"https://tableauio.github.io/#/schema/person/2"},"publisher":{"@id":"https://tableauio.github.io/#/schema/organization/1"},"image":{"@id":"https://tableauio.github.io/docs/excel/map/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://tableauio.github.io/#/schema/person/2","name":"Wenchy","sameAs":["https://twitter.com/wenchyzhu","https://www.linkedin.com/in/wenchyzhu/","https://github.com/wenchyzhu"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://tableauio.github.io/docs/excel/map/#/schema/image/2","url":"https://tableauio.github.io/tableau-logo.png","contentUrl":"https://tableauio.github.io/tableau-logo.png","caption":"Map"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://tableauio.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://tableauio.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://tableauio.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://tableauio.github.io/site.webmanifest></head><body class="docs single"><div id=announcement data-id=global-alert-946429e4c750e97753ebdc10c12b3b4d class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>🆕📢 YAML is supported now, <a class="alert-link stretched-link" href=https://tableauio.github.io/docs/yaml/scalar/>Learn More</a>!
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=Tableau>Tableau</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Tableau</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/docs/prologue/introduction/>Docs</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Tutorial
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/docs/prologue/introduction/>Introduction</a></li><li><a class=dropdown-item href=/docs/prologue/quick-start/>Quick Start</a></li></ul></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/blog/>Blog</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/tableauio/tableau><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><div class="dropdown order-md-2"><button class="btn btn-doks-light dropdown-toggle" id=doks-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
EN
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-end shadow rounded border-0" aria-labelledby=doks-languages><li><a class="dropdown-item current" aria-current=true href=/docs/excel/map/>English</a></li><li><hr class=dropdown-divider></li><li><a class=dropdown-item rel=alternate href=/nl hreflang=nl lang=nl></a></li><li><a class=dropdown-item rel=alternate href=/zh hreflang=zh lang=zh>简体中文</a></li></ul></div></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Prologue</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/prologue/introduction/>Introduction</a></li><li><a class=docs-link href=/docs/prologue/quick-start/>Quick Start</a></li></ul><h3 class="h6 text-uppercase mb-2">Tutorial</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/tutorial/config/>Tableauc config</a></li></ul><h3 class="h6 text-uppercase mb-2">Basics</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/basics/concepts/>Concepts</a></li><li><a class=docs-link href=/docs/basics/naming-convention/>Naming convention</a></li><li><a class=docs-link href=/docs/basics/grammar-and-types/>Grammar and types</a></li><li><a class=docs-link href=/docs/basics/enum/>Enum</a></li><li><a class=docs-link href=/docs/basics/wellknown-types/>Wellknown types</a></li><li><a class=docs-link href=/docs/basics/predefined-types/>Predefined types</a></li></ul><h3 class="h6 text-uppercase mb-2">Excel</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/excel/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/excel/enum/>Enum</a></li><li><a class=docs-link href=/docs/excel/struct/>Struct</a></li><li><a class=docs-link href=/docs/excel/union/>Union</a></li><li><a class=docs-link href=/docs/excel/list/>List</a></li><li><a class="docs-link active" href=/docs/excel/map/>Map</a></li><li><a class=docs-link href=/docs/excel/keyedlist/>KeyedList</a></li><li><a class=docs-link href=/docs/excel/wellknown-types/>Wellknown types</a></li><li><a class=docs-link href=/docs/excel/struct-in-struct/>Struct in struct</a></li><li><a class=docs-link href=/docs/excel/struct-in-list/>Struct in list</a></li><li><a class=docs-link href=/docs/excel/struct-in-map/>Struct in map</a></li><li><a class=docs-link href=/docs/excel/list-in-list/>List in list</a></li><li><a class=docs-link href=/docs/excel/list-in-map/>List in map</a></li><li><a class=docs-link href=/docs/excel/map-in-list/>Map in list</a></li><li><a class=docs-link href=/docs/excel/map-in-map/>Map in map</a></li><li><a class=docs-link href=/docs/excel/infinite-nesting/>Infinite nesting</a></li><li><a class=docs-link href=/docs/excel/field-property/>Field property</a></li><li><a class=docs-link href=/docs/excel/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">CSV</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/csv/overview/>Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">XML</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/xml/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/xml/enum/>Enum</a></li><li><a class=docs-link href=/docs/xml/struct/>Struct</a></li><li><a class=docs-link href=/docs/xml/union/>Union</a></li><li><a class=docs-link href=/docs/xml/list/>List</a></li><li><a class=docs-link href=/docs/xml/map/>Map</a></li><li><a class=docs-link href=/docs/xml/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">YAML</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/yaml/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/yaml/enum/>Enum</a></li><li><a class=docs-link href=/docs/yaml/struct/>Struct</a></li><li><a class=docs-link href=/docs/yaml/union/>Union</a></li><li><a class=docs-link href=/docs/yaml/list/>List</a></li><li><a class=docs-link href=/docs/yaml/map/>Map</a></li><li><a class=docs-link href=/docs/yaml/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">API</h3><ul class=list-unstyled><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Tableau</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/tableau/guide/>Guide</a></li></ul><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Loader</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/loader/overview/>Overview</a></li><li><a class=docs-link href=/docs/api/loader/cpp/>C++</a></li><li><a class=docs-link href=/docs/api/loader/go/>Go</a></li><li><a class=docs-link href=/docs/api/loader/csharp/>C#</a></li><li><a class=docs-link href=/docs/api/loader/ts/>TypeScript</a></li><li><a class=docs-link href=/docs/api/loader/lua/>Lua</a></li></ul><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Checker</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/checker/guide/>Guide</a></li></ul></ul><h3 class="h6 text-uppercase mb-2">Design</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/design/overview/>Overview</a></li><li><a class=docs-link href=/docs/design/metadata/>Metadata</a></li></ul><h3 class="h6 text-uppercase mb-2">Help</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/help/how-to-update/>How to Update</a></li><li><a class=docs-link href=/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=/docs/help/faq/>FAQ</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav id=sidebar-default class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Prologue</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/prologue/introduction/>Introduction</a></li><li><a class=docs-link href=/docs/prologue/quick-start/>Quick Start</a></li></ul><h3 class="h6 text-uppercase mb-2">Tutorial</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/tutorial/config/>Tableauc config</a></li></ul><h3 class="h6 text-uppercase mb-2">Basics</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/basics/concepts/>Concepts</a></li><li><a class=docs-link href=/docs/basics/naming-convention/>Naming convention</a></li><li><a class=docs-link href=/docs/basics/grammar-and-types/>Grammar and types</a></li><li><a class=docs-link href=/docs/basics/enum/>Enum</a></li><li><a class=docs-link href=/docs/basics/wellknown-types/>Wellknown types</a></li><li><a class=docs-link href=/docs/basics/predefined-types/>Predefined types</a></li></ul><h3 class="h6 text-uppercase mb-2">Excel</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/excel/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/excel/enum/>Enum</a></li><li><a class=docs-link href=/docs/excel/struct/>Struct</a></li><li><a class=docs-link href=/docs/excel/union/>Union</a></li><li><a class=docs-link href=/docs/excel/list/>List</a></li><li><a class="docs-link active" href=/docs/excel/map/>Map</a></li><li><a class=docs-link href=/docs/excel/keyedlist/>KeyedList</a></li><li><a class=docs-link href=/docs/excel/wellknown-types/>Wellknown types</a></li><li><a class=docs-link href=/docs/excel/struct-in-struct/>Struct in struct</a></li><li><a class=docs-link href=/docs/excel/struct-in-list/>Struct in list</a></li><li><a class=docs-link href=/docs/excel/struct-in-map/>Struct in map</a></li><li><a class=docs-link href=/docs/excel/list-in-list/>List in list</a></li><li><a class=docs-link href=/docs/excel/list-in-map/>List in map</a></li><li><a class=docs-link href=/docs/excel/map-in-list/>Map in list</a></li><li><a class=docs-link href=/docs/excel/map-in-map/>Map in map</a></li><li><a class=docs-link href=/docs/excel/infinite-nesting/>Infinite nesting</a></li><li><a class=docs-link href=/docs/excel/field-property/>Field property</a></li><li><a class=docs-link href=/docs/excel/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">CSV</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/csv/overview/>Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">XML</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/xml/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/xml/enum/>Enum</a></li><li><a class=docs-link href=/docs/xml/struct/>Struct</a></li><li><a class=docs-link href=/docs/xml/union/>Union</a></li><li><a class=docs-link href=/docs/xml/list/>List</a></li><li><a class=docs-link href=/docs/xml/map/>Map</a></li><li><a class=docs-link href=/docs/xml/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">YAML</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/yaml/scalar/>Scalar</a></li><li><a class=docs-link href=/docs/yaml/enum/>Enum</a></li><li><a class=docs-link href=/docs/yaml/struct/>Struct</a></li><li><a class=docs-link href=/docs/yaml/union/>Union</a></li><li><a class=docs-link href=/docs/yaml/list/>List</a></li><li><a class=docs-link href=/docs/yaml/map/>Map</a></li><li><a class=docs-link href=/docs/yaml/metasheet/>Metasheet</a></li></ul><h3 class="h6 text-uppercase mb-2">API</h3><ul class=list-unstyled><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Tableau</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/tableau/guide/>Guide</a></li></ul><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Loader</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/loader/overview/>Overview</a></li><li><a class=docs-link href=/docs/api/loader/cpp/>C++</a></li><li><a class=docs-link href=/docs/api/loader/go/>Go</a></li><li><a class=docs-link href=/docs/api/loader/csharp/>C#</a></li><li><a class=docs-link href=/docs/api/loader/ts/>TypeScript</a></li><li><a class=docs-link href=/docs/api/loader/lua/>Lua</a></li></ul><h4 class="h6 text-uppercase ms-3 mt-3 mb-2">Checker</h4><ul class="list-unstyled ms-3"><li><a class=docs-link href=/docs/api/checker/guide/>Guide</a></li></ul></ul><h3 class="h6 text-uppercase mb-2">Design</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/design/overview/>Overview</a></li><li><a class=docs-link href=/docs/design/metadata/>Metadata</a></li></ul><h3 class="h6 text-uppercase mb-2">Help</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/help/how-to-update/>How to Update</a></li><li><a class=docs-link href=/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=/docs/help/faq/>FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#horizontal-map>Horizontal map</a><ul><li><a href=#horizontal-scalar-map>Horizontal scalar map</a></li><li><a href=#horizontal-struct-map>Horizontal struct map</a></li><li><a href=#horizontal-predefined-struct-map>Horizontal predefined-struct map</a></li></ul></li><li><a href=#vertical-map>Vertical map</a><ul><li><a href=#vertical-scalar-map>Vertical scalar map</a></li><li><a href=#vertical-struct-map>Vertical struct map</a></li><li><a href=#vertical-predefined-struct-map>Vertical predefined-struct map</a></li></ul></li><li><a href=#incell-map>Incell map</a><ul><li><a href=#incell-scalar-map>Incell scalar map</a></li><li><a href=#incell-enum-map>Incell enum map</a></li></ul></li><li><a href=#empty-key-map>Empty key map</a></li><li><a href=#enum-key-map>Enum key map</a></li><li><a href=#horizontal-map-size>Horizontal map size</a><ul><li><a href=#dynamic-size>Dynamic size</a></li><li><a href=#fixed-size>Fixed size</a></li></ul></li><li><a href=#advanced-features>Advanced features</a><ul><li><a href=#horizontal-column-skipped-map>Horizontal column-skipped map</a></li><li><a href=#ordered-map>Ordered-map</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/excel/>Excel</a></li><li class="breadcrumb-item active" aria-current=page>Map</li></ol></nav><h1>Map</h1><p class=lead>This guide demonstrates different features of excel map type.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#horizontal-map>Horizontal map</a><ul><li><a href=#horizontal-scalar-map>Horizontal scalar map</a></li><li><a href=#horizontal-struct-map>Horizontal struct map</a></li><li><a href=#horizontal-predefined-struct-map>Horizontal predefined-struct map</a></li></ul></li><li><a href=#vertical-map>Vertical map</a><ul><li><a href=#vertical-scalar-map>Vertical scalar map</a></li><li><a href=#vertical-struct-map>Vertical struct map</a></li><li><a href=#vertical-predefined-struct-map>Vertical predefined-struct map</a></li></ul></li><li><a href=#incell-map>Incell map</a><ul><li><a href=#incell-scalar-map>Incell scalar map</a></li><li><a href=#incell-enum-map>Incell enum map</a></li></ul></li><li><a href=#empty-key-map>Empty key map</a></li><li><a href=#enum-key-map>Enum key map</a></li><li><a href=#horizontal-map-size>Horizontal map size</a><ul><li><a href=#dynamic-size>Dynamic size</a></li><li><a href=#fixed-size>Fixed size</a></li></ul></li><li><a href=#advanced-features>Advanced features</a><ul><li><a href=#horizontal-column-skipped-map>Horizontal column-skipped map</a></li><li><a href=#ordered-map>Ordered-map</a></li></ul></li></ul></nav></div></nav><h2 id=horizontal-map>Horizontal map <a href=#horizontal-map class=anchor aria-hidden=true>#</a></h2><p>There are some kinds of horizontal map:</p><ol><li>Horizontal <strong>scalar</strong> map, as map value type is scalar. E.g: <code>map&lt;int32, int32></code>.</li><li>Horizontal <strong>struct</strong> map, as map value type is struct. E.g: <code>map&lt;int32, Item></code>.</li><li>Horizontal <strong>predefined-struct</strong> map, as map value type is predefined struct. E.g: <code>map&lt;int32, .Item></code>.</li></ol><h3 id=horizontal-scalar-map>Horizontal scalar map <a href=#horizontal-scalar-map class=anchor aria-hidden=true>#</a></h3><p>No need to support, use this instead: <code>map&lt;int32, Item></code>.</p><h3 id=horizontal-struct-map>Horizontal struct map <a href=#horizontal-struct-map class=anchor aria-hidden=true>#</a></h3><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ankhjlbcdgmife-144266-tab data-bs-toggle=tab data-bs-target=#sheet-ankhjlbcdgmife-144266 type=button role=tab aria-controls=sheet-ankhjlbcdgmife-144266 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-leghbdfknmicja-144474-tab data-bs-toggle=tab data-bs-target=#sheet-leghbdfknmicja-144474 type=button role=tab aria-controls=sheet-leghbdfknmicja-144474 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ankhjlbcdgmife-144266 role=tabpanel aria-labelledby=sheet-ankhjlbcdgmife-144266-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Item1ID</th><th>Item1Name</th><th>Item2ID</th><th>Item2Name</th><th>Item3ID</th><th>Item3Name</th></tr></thead><tbody><tr><td>map&lt;uint32, Item></td><td>string</td><td>uint32</td><td>string</td><td>uint32</td><td>string</td></tr><tr><td>Item1&rsquo;s ID</td><td>Item1&rsquo;s name</td><td>Item2&rsquo;s ID</td><td>Item2&rsquo;s name</td><td>Item3&rsquo;s ID</td><td>Item3&rsquo;s name</td></tr><tr><td>1</td><td>Apple</td><td>2</td><td>Orange</td><td>3</td><td>Banana</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-leghbdfknmicja-144474 role=tabpanel aria-labelledby=sheet-leghbdfknmicja-144474-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {name:&quot;Item&quot; key:&quot;ID&quot; layout:LAYOUT_HORIZONTAL}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    string name = 2 [(tableau.field) = {name:&quot;Name&quot;}];
  }
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Apple&quot;
        },
        &quot;2&quot;: {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;Orange&quot;
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;name&quot;: &quot;Banana&quot;
        }
    }
}
</code></pre></details><h3 id=horizontal-predefined-struct-map>Horizontal predefined-struct map <a href=#horizontal-predefined-struct-map class=anchor aria-hidden=true>#</a></h3><p><code>Item</code> in <em>common.proto</em> is predefined as:</p><pre><code class=language-protobuf>message Item {
    int32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    int32 num = 2 [(tableau.field) = {name:&quot;Num&quot;}];
}
</code></pre><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-jknfdlbgeihmac-147113-tab data-bs-toggle=tab data-bs-target=#sheet-jknfdlbgeihmac-147113 type=button role=tab aria-controls=sheet-jknfdlbgeihmac-147113 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-hmlgcbdijafnek-147282-tab data-bs-toggle=tab data-bs-target=#sheet-hmlgcbdijafnek-147282 type=button role=tab aria-controls=sheet-hmlgcbdijafnek-147282 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-jknfdlbgeihmac-147113 role=tabpanel aria-labelledby=sheet-jknfdlbgeihmac-147113-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Item1ID</th><th>Item1Num</th><th>Item2ID</th><th>Item2Num</th><th>Item3ID</th><th>Item3Num</th></tr></thead><tbody><tr><td>map&lt;int32, .Item></td><td>int32</td><td>int32</td><td>int32</td><td>int32</td><td>int32</td></tr><tr><td>Item1&rsquo;s ID</td><td>Item1&rsquo;s num</td><td>Item2&rsquo;s ID</td><td>Item3&rsquo;s num</td><td>Item3&rsquo;s ID</td><td>Item3&rsquo;s num</td></tr><tr><td>1</td><td>100</td><td>2</td><td>200</td><td>3</td><td>300</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-hmlgcbdijafnek-147282 role=tabpanel aria-labelledby=sheet-hmlgcbdijafnek-147282-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
import &quot;common.proto&quot;;
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;int32, protoconf.Item&gt; item_map = 1 [(tableau.field) = {name:&quot;Item&quot; key:&quot;ID&quot; layout:LAYOUT_HORIZONTAL}];
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;num&quot;: 100
        },
        &quot;2&quot;: {
            &quot;id&quot;: 2,
            &quot;num&quot;: 200
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;num&quot;: 300
        }
    }
}
</code></pre></details><h2 id=vertical-map>Vertical map <a href=#vertical-map class=anchor aria-hidden=true>#</a></h2><p>There are some kinds of vertical map:</p><ol><li>Vertical <strong>scalar</strong> map, as map value type is scalar. E.g: <code>map&lt;int32, int32></code>.</li><li>Vertical <strong>struct</strong> map, as map value type is struct. E.g: <code>map&lt;int32, Item></code>.</li><li>Vertical <strong>predefined-struct</strong> map, as map value type is predefined struct. E.g: <code>map&lt;int32, .Item></code>.</li></ol><h3 id=vertical-scalar-map>Vertical scalar map <a href=#vertical-scalar-map class=anchor aria-hidden=true>#</a></h3><p>No need to support, use <code>map&lt;int32, Item></code> instead.</p><h3 id=vertical-struct-map>Vertical struct map <a href=#vertical-struct-map class=anchor aria-hidden=true>#</a></h3><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-hefginbajmkcld-149934-tab data-bs-toggle=tab data-bs-target=#sheet-hefginbajmkcld-149934 type=button role=tab aria-controls=sheet-hefginbajmkcld-149934 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-dcglhimfnjaekb-150103-tab data-bs-toggle=tab data-bs-target=#sheet-dcglhimfnjaekb-150103 type=button role=tab aria-controls=sheet-dcglhimfnjaekb-150103 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-hefginbajmkcld-149934 role=tabpanel aria-labelledby=sheet-hefginbajmkcld-149934-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>ID</th><th>Name</th><th>Desc</th></tr></thead><tbody><tr><td>map&lt;uint32, Item></td><td>string</td><td>string</td></tr><tr><td>Item’s ID</td><td>Item’s name</td><td>Item’s desc</td></tr><tr><td>1</td><td>Apple</td><td>A kind of delicious fruit.</td></tr><tr><td>2</td><td>Orange</td><td>A kind of sour fruit.</td></tr><tr><td>3</td><td>Banana</td><td>A kind of calorie-rich fruit.</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-dcglhimfnjaekb-150103 role=tabpanel aria-labelledby=sheet-dcglhimfnjaekb-150103-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {key:&quot;ID&quot; layout:LAYOUT_VERTICAL}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    string name = 2 [(tableau.field) = {name:&quot;Name&quot;}];
    string desc = 3 [(tableau.field) = {name:&quot;Desc&quot;}];
  }
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Apple&quot;,
            &quot;desc&quot;: &quot;A kind of delicious fruit.&quot;
        },
        &quot;2&quot;: {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;Orange&quot;,
            &quot;desc&quot;: &quot;A kind of sour fruit.&quot;
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;name&quot;: &quot;Banana&quot;,
            &quot;desc&quot;: &quot;A kind of calorie-rich fruit.&quot;
        }
    }
}
</code></pre></details><h3 id=vertical-predefined-struct-map>Vertical predefined-struct map <a href=#vertical-predefined-struct-map class=anchor aria-hidden=true>#</a></h3><p><code>Item</code> in <em>common.proto</em> is predefined as:</p><pre><code class=language-protobuf>message Item {
    int32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    int32 num = 2 [(tableau.field) = {name:&quot;Num&quot;}];
}
</code></pre><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-kjifehmldbncga-152469-tab data-bs-toggle=tab data-bs-target=#sheet-kjifehmldbncga-152469 type=button role=tab aria-controls=sheet-kjifehmldbncga-152469 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-nefgiabmdhclkj-152651-tab data-bs-toggle=tab data-bs-target=#sheet-nefgiabmdhclkj-152651 type=button role=tab aria-controls=sheet-nefgiabmdhclkj-152651 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-kjifehmldbncga-152469 role=tabpanel aria-labelledby=sheet-kjifehmldbncga-152469-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>ID</th><th>Num</th></tr></thead><tbody><tr><td>map&lt;int32, .Item></td><td>int32</td></tr><tr><td>Item&rsquo;s ID</td><td>Item&rsquo;s num</td></tr><tr><td>1</td><td>100</td></tr><tr><td>2</td><td>200</td></tr><tr><td>3</td><td>300</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-nefgiabmdhclkj-152651 role=tabpanel aria-labelledby=sheet-nefgiabmdhclkj-152651-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
import &quot;common.proto&quot;;
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;int32, protoconf.Item&gt; item_map = 1 [(tableau.field) = {key:&quot;ID&quot; layout:LAYOUT_VERTICAL}];
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;num&quot;: 100
        },
        &quot;2&quot;: {
            &quot;id&quot;: 2,
            &quot;num&quot;: 200
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;num&quot;: 300
        }
    }
}
</code></pre></details><h2 id=incell-map>Incell map <a href=#incell-map class=anchor aria-hidden=true>#</a></h2><p>There are some kinds of in-cell map:</p><ol><li>in-cell <strong>scalar</strong> map, as map value type is scalar. E.g: <code>map&lt;int32, int32></code>.</li><li>in-cell <strong>struct</strong> map, as map value type is struct. E.g: <code>map&lt;int32, Item></code>.</li></ol><h3 id=incell-scalar-map>Incell scalar map <a href=#incell-scalar-map class=anchor aria-hidden=true>#</a></h3><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-knalfmgdecjibh-154783-tab data-bs-toggle=tab data-bs-target=#sheet-knalfmgdecjibh-154783 type=button role=tab aria-controls=sheet-knalfmgdecjibh-154783 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-fjnhcdbaglekmi-154952-tab data-bs-toggle=tab data-bs-target=#sheet-fjnhcdbaglekmi-154952 type=button role=tab aria-controls=sheet-fjnhcdbaglekmi-154952 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-knalfmgdecjibh-154783 role=tabpanel aria-labelledby=sheet-knalfmgdecjibh-154783-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Item</th></tr></thead><tbody><tr><td>map&lt;uint32, string></td></tr><tr><td>Item key-value pairs</td></tr><tr><td>1:Apple,2:Orange,3:Banana,4,:Peach</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-fjnhcdbaglekmi-154952 role=tabpanel aria-labelledby=sheet-fjnhcdbaglekmi-154952-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>The <code>Item</code> column&rsquo;s type is in-cell map <code>map&lt;uint32, string></code>, as the map value is scalar type <code>string</code>.</p><blockquote><p>⚠️ NOTE: If you want explicit pattern like: <code>[Key:Value]...</code>, then set the field property <code>present</code> as true.
See <a href=/docs/excel/field-property/#option-present>Option <code>present</code> →</a>.</p></blockquote><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, string&gt; item_map = 1 [(tableau.field) = {name:&quot;Item&quot; layout:LAYOUT_INCELL}];
}
</code></pre></details><details open><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;0&quot;: &quot;Peach&quot;,
        &quot;1&quot;: &quot;Apple&quot;,
        &quot;2&quot;: &quot;Orange&quot;,
        &quot;3&quot;: &quot;Banana&quot;,
        &quot;4&quot;:  &quot;&quot;
    }
}
</code></pre></details><h3 id=incell-enum-map>Incell enum map <a href=#incell-enum-map class=anchor aria-hidden=true>#</a></h3><p>For incell map, both the key and value can be enum types.</p><p>For example, predefined enum types <code>FruitType</code> and <code>FruitFlavor</code> in <em>common.proto</em> are:</p><pre><code class=language-protobuf>enum FruitType {
  FRUIT_TYPE_UNKNOWN = 0 [(tableau.evalue).name = &quot;Unknown&quot;];
  FRUIT_TYPE_APPLE   = 1 [(tableau.evalue).name = &quot;Apple&quot;];
  FRUIT_TYPE_ORANGE  = 2 [(tableau.evalue).name = &quot;Orange&quot;];
  FRUIT_TYPE_BANANA  = 3 [(tableau.evalue).name = &quot;Banana&quot;];
}

enum FruitFlavor {
  FRUIT_FLAVOR_UNKNOWN = 0 [(tableau.evalue).name = &quot;Unknown&quot;];
  FRUIT_FLAVOR_FRAGRANT = 1 [(tableau.evalue).name = &quot;Fragrant&quot;];
  FRUIT_FLAVOR_SOUR = 2 [(tableau.evalue).name = &quot;Sour&quot;];
  FRUIT_FLAVOR_SWEET = 3 [(tableau.evalue).name = &quot;Sweet&quot;];
}
</code></pre><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ajmhikecfdgbln-157435-tab data-bs-toggle=tab data-bs-target=#sheet-ajmhikecfdgbln-157435 type=button role=tab aria-controls=sheet-ajmhikecfdgbln-157435 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-flbemkdhangijc-157617-tab data-bs-toggle=tab data-bs-target=#sheet-flbemkdhangijc-157617 type=button role=tab aria-controls=sheet-flbemkdhangijc-157617 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ajmhikecfdgbln-157435 role=tabpanel aria-labelledby=sheet-ajmhikecfdgbln-157435-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Fruit</th><th>Flavor</th><th>Item</th></tr></thead><tbody><tr><td>map&lt;enum&lt;.FruitType>, int64></td><td>map&lt;int64, enum&lt;.FruitFlavor&#187;</td><td>map&lt;enum&lt;.FruitType>, enum&lt;.FruitFlavor&#187;</td></tr><tr><td>Fruits</td><td>Flavors</td><td>Items</td></tr><tr><td>Apple:1,Orange:2</td><td>1:Fragrant,2:Sweet</td><td>Apple:Fragrant,Orange:Sour</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-flbemkdhangijc-157617 role=tabpanel aria-labelledby=sheet-flbemkdhangijc-157617-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
import &quot;common.proto&quot;;
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;int32, Fruit&gt; fruit_map = 1 [(tableau.field) = {name:&quot;Fruit&quot; key:&quot;Key&quot; layout:LAYOUT_INCELL}];
  message Fruit {
    protoconf.FruitType key = 1 [(tableau.field) = {name:&quot;Key&quot;}];
    int64 value = 2 [(tableau.field) = {name:&quot;Value&quot;}];
  }
  map&lt;int64, protoconf.FruitFlavor&gt; flavor_map = 2 [(tableau.field) = {name:&quot;Flavor&quot; layout:LAYOUT_INCELL}];
  map&lt;int32, Item&gt; item_map = 3 [(tableau.field) = {name:&quot;Item&quot; key:&quot;Key&quot; layout:LAYOUT_INCELL}];
  message Item {
    protoconf.FruitType key = 1 [(tableau.field) = {name:&quot;Key&quot;}];
    protoconf.FruitFlavor value = 2 [(tableau.field) = {name:&quot;Value&quot;}];
  }
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;fruitMap&quot;: {
        &quot;1&quot;: {
            &quot;key&quot;: &quot;FRUIT_TYPE_APPLE&quot;,
            &quot;value&quot;: &quot;1&quot;
        },
        &quot;3&quot;: {
            &quot;key&quot;: &quot;FRUIT_TYPE_ORANGE&quot;,
            &quot;value&quot;: &quot;2&quot;
        }
    },
    &quot;flavorMap&quot;: {
        &quot;1&quot;: &quot;FRUIT_FLAVOR_FRAGRANT&quot;,
        &quot;2&quot;: &quot;FRUIT_FLAVOR_SWEET&quot;
    },
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;key&quot;: &quot;FRUIT_TYPE_APPLE&quot;,
            &quot;value&quot;: &quot;FRUIT_FLAVOR_FRAGRANT&quot;
        },
        &quot;3&quot;: {
            &quot;key&quot;: &quot;FRUIT_TYPE_ORANGE&quot;,
            &quot;value&quot;: &quot;FRUIT_FLAVOR_SOUR&quot;
        }
    }
}
</code></pre></details><h2 id=empty-key-map>Empty key map <a href=#empty-key-map class=anchor aria-hidden=true>#</a></h2><p>If map key is not configured, then it will be treated as default value of map key type. Default value is illustrated at <a href=/docs/basics/grammar-and-types/#scalar-types>Scalar types →</a>.</p><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ibdgcmfnkhlaje-160646-tab data-bs-toggle=tab data-bs-target=#sheet-ibdgcmfnkhlaje-160646 type=button role=tab aria-controls=sheet-ibdgcmfnkhlaje-160646 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-jadflnebkighmc-160828-tab data-bs-toggle=tab data-bs-target=#sheet-jadflnebkighmc-160828 type=button role=tab aria-controls=sheet-jadflnebkighmc-160828 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ibdgcmfnkhlaje-160646 role=tabpanel aria-labelledby=sheet-ibdgcmfnkhlaje-160646-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>ID</th><th>Desc</th></tr></thead><tbody><tr><td>map&lt;uint32, Item></td><td>string</td></tr><tr><td>Item&rsquo;s ID</td><td>Item&rsquo;s name</td></tr><tr><td>1</td><td>Apple</td></tr><tr><td></td><td>Orange</td></tr><tr><td>3</td><td>Banana</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-jadflnebkighmc-160828 role=tabpanel aria-labelledby=sheet-jadflnebkighmc-160828-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {key:&quot;ID&quot; layout:LAYOUT_VERTICAL}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    string desc = 2 [(tableau.field) = {name:&quot;Desc&quot;}];
  }
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;0&quot;: {
            &quot;id&quot;: 0,
            &quot;desc&quot;: &quot;Orange&quot;
        },
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;desc&quot;: &quot;Apple&quot;
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;desc&quot;: &quot;Banana&quot;
        }
    }
}
</code></pre></details><h2 id=enum-key-map>Enum key map <a href=#enum-key-map class=anchor aria-hidden=true>#</a></h2><p>As the protobuf documents the restrictions of <a href=https://developers.google.com/protocol-buffers/docs/proto3#maps>map key type</a>:</p><blockquote><p>&mldr; the <code>key_type</code> can be any integral or string type (so, any
<a href=https://developers.google.com/protocol-buffers/docs/proto3#scalar>scalar</a> type
except for floating point types and <code>bytes</code>). Note that <code>enum</code> is not a valid <code>key_type</code>.</p></blockquote><p>However, key type as enum is very useful in some situations. So we
support it in a simple way:</p><ul><li>enum type is treated as <code>int32</code> as map key type，</li><li>enum type is reserved in map value type (struct).</li></ul><p>For example, <code>FruitType</code> in <em>common.proto</em> is predefined as:</p><pre><code class=language-protobuf>enum FruitType {
  FRUIT_TYPE_UNKNOWN = 0 [(tableau.evalue).name = &quot;Unknown&quot;];
  FRUIT_TYPE_APPLE   = 1 [(tableau.evalue).name = &quot;Apple&quot;];
  FRUIT_TYPE_ORANGE  = 3 [(tableau.evalue).name = &quot;Orange&quot;];
  FRUIT_TYPE_BANANA  = 4 [(tableau.evalue).name = &quot;Banana&quot;];
}
</code></pre><p>then <code>map&lt;enum&lt;.FruitType>, ValueType></code> will be converted to <code>map&lt;int32, ValueType></code>,
and <code>FruitType</code> is reserved in <code>ValueType</code>:</p><pre><code class=language-protobuf>message ValueType {
  FruitType key = 1;
  ...
}
</code></pre><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ifebdmahkjcngl-163558-tab data-bs-toggle=tab data-bs-target=#sheet-ifebdmahkjcngl-163558 type=button role=tab aria-controls=sheet-ifebdmahkjcngl-163558 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-lgkcneamhbjdif-163727-tab data-bs-toggle=tab data-bs-target=#sheet-lgkcneamhbjdif-163727 type=button role=tab aria-controls=sheet-lgkcneamhbjdif-163727 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ifebdmahkjcngl-163558 role=tabpanel aria-labelledby=sheet-ifebdmahkjcngl-163558-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Type</th><th>Price</th></tr></thead><tbody><tr><td>map&lt;enum&lt;.FruitType>, Item></td><td>int32</td></tr><tr><td>Item&rsquo;s type</td><td>Item&rsquo;s price</td></tr><tr><td>Apple</td><td>100</td></tr><tr><td>Orange</td><td>200</td></tr><tr><td>Banana</td><td>300</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-lgkcneamhbjdif-163727 role=tabpanel aria-labelledby=sheet-lgkcneamhbjdif-163727-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details open><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
import &quot;common.proto&quot;;
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;int32, Item&gt; item_map = 1 [(tableau.field) = {key:&quot;Type&quot; layout:LAYOUT_VERTICAL}];
  message Item {
    protoconf.FruitType type = 1 [(tableau.field) = {name:&quot;Type&quot;}];
    int32 price = 2 [(tableau.field) = {name:&quot;Price&quot;}];
  }
}
</code></pre></details><details><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;type&quot;: &quot;FRUIT_TYPE_APPLE&quot;,
            &quot;price&quot;: 100
        },
        &quot;3&quot;: {
            &quot;type&quot;: &quot;FRUIT_TYPE_ORANGE&quot;,
            &quot;price&quot;: 200
        },
        &quot;4&quot;: {
            &quot;type&quot;: &quot;FRUIT_TYPE_BANANA&quot;,
            &quot;price&quot;: 300
        }
    }
}
</code></pre></details><h2 id=horizontal-map-size>Horizontal map size <a href=#horizontal-map-size class=anchor aria-hidden=true>#</a></h2><h3 id=dynamic-size>Dynamic size <a href=#dynamic-size class=anchor aria-hidden=true>#</a></h3><p>By default, all maps are <strong>Dynamically Sized Types</strong>. Map items should be present continuously, otherwise an error is reported if an empty item is existed in between.</p><h3 id=fixed-size>Fixed size <a href=#fixed-size class=anchor aria-hidden=true>#</a></h3><h4 id=implicit-fixed-size>Implicit fixed size <a href=#implicit-fixed-size class=anchor aria-hidden=true>#</a></h4><p>The map size is auto resolved by the max map items present in name row.</p><p>In this example below, though the second map item <strong>Item2</strong> is empty, it is legal as the field property <code>fixed</code> is set <code>true</code>. Besides, <strong>Item2</strong> will also be generated as an empty map item. You can see it in the generated file <em>ItemConf.json</em>.</p><div class="alert alert-info d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>If more than one empty map items are inserted into map, then only one empty map item is really generated. Because all the empty map items's keys are same. This is different from list, you should pay special attention to it.</div></div><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ncgbkdmliehafj-166340-tab data-bs-toggle=tab data-bs-target=#sheet-ncgbkdmliehafj-166340 type=button role=tab aria-controls=sheet-ncgbkdmliehafj-166340 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-bgjhaefknldmci-166522-tab data-bs-toggle=tab data-bs-target=#sheet-bgjhaefknldmci-166522 type=button role=tab aria-controls=sheet-bgjhaefknldmci-166522 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ncgbkdmliehafj-166340 role=tabpanel aria-labelledby=sheet-ncgbkdmliehafj-166340-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Item1ID</th><th>Item1Name</th><th>Item2ID</th><th>Item2Name</th><th>Item3ID</th><th>Item3Name</th></tr></thead><tbody><tr><td>map&lt;uint32, Item>|{fixed:true}</td><td>string</td><td>uint32</td><td>string</td><td>uint32</td><td>string</td></tr><tr><td>Item1&rsquo;s ID</td><td>Item1&rsquo;s name</td><td>Item2&rsquo;s ID</td><td>Item2&rsquo;s name</td><td>Item3&rsquo;s ID</td><td>Item3&rsquo;s name</td></tr><tr><td>1</td><td>Apple</td><td></td><td></td><td>3</td><td>Banana</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-bgjhaefknldmci-166522 role=tabpanel aria-labelledby=sheet-bgjhaefknldmci-166522-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {name:&quot;Item&quot; key:&quot;ID&quot; layout:LAYOUT_HORIZONTAL prop:{fixed:true}}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    string name = 2 [(tableau.field) = {name:&quot;Name&quot;}];
  }
}
</code></pre></details><details open><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;0&quot;: {
            &quot;id&quot;: 0,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Apple&quot;
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;name&quot;: &quot;Banana&quot;
        }
    }
}
</code></pre></details><h4 id=explicit-fixed-size>Explicit fixed size <a href=#explicit-fixed-size class=anchor aria-hidden=true>#</a></h4><p>The map size is explicitly set by field property <code>size</code>.</p><p>In this example below, field property <code>size</code> is set as 2, then map items after the second item <strong>Item2</strong> will all be truncated. Besides, <strong>Item2</strong> will also be generated as an empty map item. You can see it in the generated file <em>ItemConf.json</em>.</p><div class="alert alert-info d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>If more than one empty map items are inserted into map, then only one empty map item is really generated. Because all the empty map items's keys are same. This is different from list, you should pay special attention to it.</div></div><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-dlcefnimhagkjb-168966-tab data-bs-toggle=tab data-bs-target=#sheet-dlcefnimhagkjb-168966 type=button role=tab aria-controls=sheet-dlcefnimhagkjb-168966 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-ehdimaglnfcjkb-169122-tab data-bs-toggle=tab data-bs-target=#sheet-ehdimaglnfcjkb-169122 type=button role=tab aria-controls=sheet-ehdimaglnfcjkb-169122 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-dlcefnimhagkjb-168966 role=tabpanel aria-labelledby=sheet-dlcefnimhagkjb-168966-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>Item1ID</th><th>Item1Name</th><th>Item2ID</th><th>Item2Name</th><th>Item3ID</th><th>Item3Name</th></tr></thead><tbody><tr><td>map&lt;uint32, Item>|{size:2}</td><td>string</td><td>uint32</td><td>string</td><td>uint32</td><td>string</td></tr><tr><td>Item1&rsquo;s ID</td><td>Item1&rsquo;s name</td><td>Item2&rsquo;s ID</td><td>Item2&rsquo;s name</td><td>Item3&rsquo;s ID</td><td>Item3&rsquo;s name</td></tr><tr><td>1</td><td>Apple</td><td></td><td></td><td>3</td><td>Banana</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-ehdimaglnfcjkb-169122 role=tabpanel aria-labelledby=sheet-ehdimaglnfcjkb-169122-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {name:&quot;Item&quot; key:&quot;ID&quot; layout:LAYOUT_HORIZONTAL prop:{size:2}}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    string name = 2 [(tableau.field) = {name:&quot;Name&quot;}];
  }
}
</code></pre></details><details open><summary>ItemConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;0&quot;: {
            &quot;id&quot;: 0,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Apple&quot;
        }
    }
}
</code></pre></details><h2 id=advanced-features>Advanced features <a href=#advanced-features class=anchor aria-hidden=true>#</a></h2><h3 id=horizontal-column-skipped-map>Horizontal column-skipped map <a href=#horizontal-column-skipped-map class=anchor aria-hidden=true>#</a></h3><p>A worksheet <code>ItemConf</code> in <em>HelloWorld.xlsx</em>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-ahbickenjdlgmf-172450-tab data-bs-toggle=tab data-bs-target=#sheet-ahbickenjdlgmf-172450 type=button role=tab aria-controls=sheet-ahbickenjdlgmf-172450 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-admlfjkcgehnib-172658-tab data-bs-toggle=tab data-bs-target=#sheet-admlfjkcgehnib-172658 type=button role=tab aria-controls=sheet-admlfjkcgehnib-172658 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-ahbickenjdlgmf-172450 role=tabpanel aria-labelledby=sheet-ahbickenjdlgmf-172450-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th style=text-align:left>D</th><th style=text-align:left>Prop1ID</th><th style=text-align:left></th><th style=text-align:left>Prop1Value</th><th style=text-align:left>Prop2ID</th><th style=text-align:left></th><th style=text-align:left>Prop2Value</th></tr></thead><tbody><tr><td style=text-align:left>map&lt;uint32, Item></td><td style=text-align:left>map&lt;int32, Prop></td><td style=text-align:left></td><td style=text-align:left>int32</td><td style=text-align:left>int32</td><td style=text-align:left></td><td style=text-align:left>int32</td></tr><tr><td style=text-align:left>Item&rsquo;s ID</td><td style=text-align:left>Prop1’s ID</td><td style=text-align:left>Prop1’s name</td><td style=text-align:left>Prop1’s value</td><td style=text-align:left>Prop2’s ID</td><td style=text-align:left>Prop2’s name</td><td style=text-align:left>Prop2’s value</td></tr><tr><td style=text-align:left>1</td><td style=text-align:left>1</td><td style=text-align:left>Apple</td><td style=text-align:left>100</td><td style=text-align:left>2</td><td style=text-align:left>Orange</td><td style=text-align:left>200</td></tr><tr><td style=text-align:left>2</td><td style=text-align:left>3</td><td style=text-align:left>Banana</td><td style=text-align:left>300</td><td style=text-align:left>4</td><td style=text-align:left>Pomelo</td><td style=text-align:left>400</td></tr><tr><td style=text-align:left>3</td><td style=text-align:left>5</td><td style=text-align:left>Watermelon</td><td style=text-align:left>500</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-admlfjkcgehnib-172658 role=tabpanel aria-labelledby=sheet-admlfjkcgehnib-172658-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div></div></div></div><p>Generated:</p><details open><summary>hello_world.proto</summary><pre><code class=language-protobuf>// --snip--
option (tableau.workbook) = {name:&quot;HelloWorld.xlsx&quot; namerow:1 typerow:2 noterow:3 datarow:4};

message ItemConf {
  option (tableau.worksheet) = {name:&quot;ItemConf&quot;};

  map&lt;uint32, Item&gt; item_map = 1 [(tableau.field) = {key:&quot;ID&quot; layout:LAYOUT_VERTICAL}];
  message Item {
    uint32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
    map&lt;int32, Prop&gt; prop_map = 2 [(tableau.field) = {name:&quot;Prop&quot; key:&quot;ID&quot; layout:LAYOUT_HORIZONTAL}];
    message Prop {
      int32 id = 1 [(tableau.field) = {name:&quot;ID&quot;}];
      int32 value = 2 [(tableau.field) = {name:&quot;Value&quot;}];
    }
  }
}
</code></pre></details><details><summary>HeroConf.json</summary><pre><code class=language-json>{
    &quot;itemMap&quot;: {
        &quot;1&quot;: {
            &quot;id&quot;: 1,
            &quot;desc&quot;: &quot;item1&quot;,
            &quot;propertyMap&quot;: {
                &quot;1&quot;: {
                    &quot;id&quot;: 1,
                    &quot;value&quot;: &quot;10&quot;
                },
                &quot;2&quot;: {
                    &quot;id&quot;: 2,
                    &quot;value&quot;: &quot;20&quot;
                }
            }
        },
        &quot;2&quot;: {
            &quot;id&quot;: 2,
            &quot;desc&quot;: &quot;item2&quot;,
            &quot;propertyMap&quot;: {
                &quot;3&quot;: {
                    &quot;id&quot;: 3,
                    &quot;value&quot;: &quot;30&quot;
                },
                &quot;4&quot;: {
                    &quot;id&quot;: 4,
                    &quot;value&quot;: &quot;40&quot;
                }
            }
        },
        &quot;3&quot;: {
            &quot;id&quot;: 3,
            &quot;desc&quot;: &quot;item3&quot;,
            &quot;propertyMap&quot;: {
                &quot;5&quot;: {
                    &quot;id&quot;: 5,
                    &quot;value&quot;: &quot;50&quot;
                }
            }
        }
    }
}
</code></pre></details><h3 id=ordered-map>Ordered-map <a href=#ordered-map class=anchor aria-hidden=true>#</a></h3><p>In the metasheet <code>@TABLEAU</code>, set the <code>OrderedMap</code> option to <code>true</code>, then
ordered map accessers will be generated. This feature is powered by <a href=https://github.com/tableauio/loader>tableauio/loader</a>. Currently supported programming languages are:</p><ul><li><input checked disabled type=checkbox> C++</li><li><input checked disabled type=checkbox> Go</li><li><input disabled type=checkbox> C#</li><li><input disabled type=checkbox> JS/TS</li></ul><h4 id=example>Example <a href=#example class=anchor aria-hidden=true>#</a></h4><p>If we want <code>ItemConf</code> to generate ordered map accessers, then set
<code>OrderedMap</code> option to <code>true</code> of metasheet <code>@TABLEAU</code>:</p><div class="table-responsive spreadsheet"><div class=text-center><button type=button id=download-btn class="btn btn-sm btn-outline-success fw-light fst-italic border-0 border-bottom"><span>HelloWorld.xlsx</span>&nbsp;<img height=14px src=/images/download_black.svg alt=Download></button></div><ul class="nav nav-tabs" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=sheet-mdkfacienglhjb-175466-tab data-bs-toggle=tab data-bs-target=#sheet-mdkfacienglhjb-175466 type=button role=tab aria-controls=sheet-mdkfacienglhjb-175466 aria-selected=" active ">ItemConf</button></li><li class=nav-item role=presentation><button class=nav-link id=sheet-dhacimnflkjgbe-175674-tab data-bs-toggle=tab data-bs-target=#sheet-dhacimnflkjgbe-175674 type=button role=tab aria-controls=sheet-dhacimnflkjgbe-175674 aria-selected=" false ">@TABLEAU</button></li></ul><div class=tab-content><div class="tab-pane fade active show" id=sheet-mdkfacienglhjb-175466 role=tabpanel aria-labelledby=sheet-mdkfacienglhjb-175466-tab><div class="table-responsive text-nowrap sheet sheet-colored"><table><thead><tr><th>ID</th><th>Name</th></tr></thead><tbody><tr><td>map&lt;uint32, Item></td><td>string</td></tr><tr><td>Item&rsquo;s ID</td><td>Item&rsquo;s Name</td></tr><tr><td>1</td><td>Apple</td></tr><tr><td>2</td><td>Orange</td></tr><tr><td>3</td><td>Banana</td></tr></tbody></table></div></div><div class="tab-pane fade" id=sheet-dhacimnflkjgbe-175674 role=tabpanel aria-labelledby=sheet-dhacimnflkjgbe-175674-tab><div class="table-responsive text-nowrap sheet"><table><thead><tr><th>Sheet</th><th>OrderedMap</th></tr></thead><tbody><tr><td>ItemConf</td><td>true</td></tr></tbody></table></div></div></div></div><p>More useful options are illustrated at metasheet chapter. <a href=/docs/excel/metasheet/>Metasheet @TABLEAU →</a></p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=last-modified><a href=https://github.com/tableauio/tableauio.github.io/commit/79dabf5a118b04b979d1ba93be3aa4b8fede500e><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Last modified on May 30, 2025</a></div><div class=edit-page><a href=https://github.com/tableauio/tableauio.github.io/blob/master/content/en/docs/excel/map.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/excel/list/><div class="card my-1"><div class="card-body py-2">&larr; List</div></div></a><a class=ms-auto href=/docs/excel/keyedlist/><div class="card my-1"><div class="card-body py-2">KeyedList &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://github.com/tableauio/tableauio.github.io>Tableauio</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/spreadsheet.js defer></script>
<script src=/js/bootstrap.min.cac9ae40bc48ad426b96a5939f5f4423a422be792f2ac2e8c33fc98a348b1443720b12436bd6dfaaca405d8794ae4a9f063aeef920288e8cbd6c3fe2f807d470.js integrity="sha512-ysmuQLxIrUJrlqWTn19EI6QivnkvKsLowz/JijSLFENyCxJDa9bfqspAXYeUrkqfBjru+SAojoy9bD/i+AfUcA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.2b61fbe02d8551aad3e67eee1dd43fbd2b40bc2429765aabe74217b80a8ecb44dbd234676bf79a2fe9388cbbd65cce285e7b5c11689105838f9f24e600bcd4c5.js integrity="sha512-K2H74C2FUarT5n7uHdQ/vStAvCQpdlqr50IXuAqOy0Tb0jRna/eaL+k4jLvWXM4oXntcEWiRBYOPnyTmALzUxQ==" crossorigin=anonymous defer></script>
<script src=/main.min.6e11f747641466cd267c4fed495306b0375edb34dff9b793ea5b5cf5a89558cee090af2567a8c9ce1a8e1651aa45361004c1bc211edb554c6736aae66c099f86.js integrity="sha512-bhH3R2QUZs0mfE/tSVMGsDde2zTf+beT6ltc9aiVWM7gkK8lZ6jJzhqOFlGqRTYQBMG8IR7bVUxnNqrmbAmfhg==" crossorigin=anonymous defer></script>
<script src=https://tableauio.github.io/index.min.0b101f0b101579b98c4b9b1e5cb1952ed1c8cb411b3d633940d3a125dcee4e2ba402c56250256346f112f3b08a2dc62448eb37e6db6063193ddd79a20ec7bb91.js integrity="sha512-CxAfCxAVebmMS5seXLGVLtHIy0EbPWM5QNOhJdzuTiukAsViUCVjRvES87CKLcYkSOs35ttgYxk93XmiDse7kQ==" crossorigin=anonymous defer></script></body></html>